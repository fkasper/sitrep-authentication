# Documents inside authentication
Terminology: A document is an entity, that consists of an undefined ammount of sub-entities(called components or children).

**Status:** WorkInProgress
**Updated at:** 12/16/2015
**Updated by:** Florian Kasper


A document has a specified structure:

StyleDef describes the styling elements on a COMPLETE Document.

### Widgets and Documents
A widget gets loaded via the websocket sidechannel once it is needed. It then pulls its styles from the documents `styles` section. The default style parameters from the widget will be overridden by the new applied ones.

The renderer requests a widget based on `skinRef` or `compRef`.

```pseudo
struct StyleDef {
  id string
  type string (describes scope)
  meta HashMap[string, any]
    isHidden bool
  topSkin string (java package identifier)
  style HashMap[string, any]
    properties HashMap[string, string]
}

struct DataDef {
  any_custom_mongodb_val any
  description string
  height int
  width int
  id rand_string
  skinRef string (java package style)
  compRef string (java package style)
  meta HashMap[string, any]
    isHidden bool
}

struct PropertyDef {
  //WIP
}

struct Document {
  _id ObjectId
  styles HashMap[StyleDef.id, Struct[StyleDef]]
  data HashMap[DataDef.id, Struct[DataDef]]
  properties Hashmap[PropertyDef.id, Struct[PropertyDef]]
  type String
  styleId String
  children Array[Element]
}
```

A document is referenced by an ID generated by MongoDB on creation, and can be queried by anyone with the appropriate URL.


### Storage
A document is stored within mongoDB. This document storage gives an extremly robust and easy to maintain - document near - data structure. Cassandra would not fit this case. Mainly because of the Cassandra `read > write` philosophy and secondary because Cassandra simply is has a column structure, while MongoDB focuses on Documents.

### Caching
Caching should be configurable within a) Application Settings - for dev mode purposes and b) the page itself. Once a user is logged in he should see the non cached page, while a not logged in user should see a cached version (It should be configurable if logged in users should have caching enabled)

Caching should rely on Redis or Memcached. As a document is not a finished HTML page, but just a part there is no advice on HTML caching or pre-rendering here.

A cache should expire within a reasonable ammount of time. It should expire as soon as a user saves a page, or after 1 day max.


### Relation to a Page
A document SHOULD be related to one or many pages at once. A document has a scope, it is valid for (global or page specific). Global styles inherit from the top `MasterPage` or Layout (if defined).Local styles may contain page related information for example a contact form if on a contact page.
